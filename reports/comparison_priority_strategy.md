# 人气榜TOP10开盘买入策略：买入优先级对比分析

## 测试目的
对比两种买入优先级策略的回测表现：
1. **策略A（优先买入人气高的）**: 优先买入hot_rank=1,2,3...（人气排名靠前）
2. **策略B（优先买入人气低的）**: 优先买入hot_rank=10,9,8...（人气排名靠后，但仍在前10）

## 测试配置
- **回测周期**: 2025-01-02 至 2025-12-31（约243个交易日）
- **初始资金**: 100,000
- **股票池**: 东财人气榜前10名
- **买入时机**: T日开盘价（基于T-1日人气榜）
- **卖出条件**: 
  - T日收盘不是涨停板，OR
  - T日人气排名跌出前50名
- **持仓限制**: 最多2只（cash_splits=2）
- **每笔资金**: 50%可用资金（per_trade_cash_frac=0.5）

## 回测结果对比

### 策略A：优先买入人气高的（rank 1→10）

| 指标 | 数值 |
|------|------|
| 交易笔数 | 48笔 |
| 最终净值 | 42,798.30 |
| **总收益率** | **-57.20%** |
| 盈利笔数 | 17笔 (35.4%) |
| 亏损笔数 | 31笔 (64.6%) |
| 平均持仓天数 | 2.17天 |
| 平均收益率 | -2.47% |
| 盈利交易平均收益 | +3,672.61 (+7.47%) |
| 亏损交易平均亏损 | -3,859.23 (-7.93%) |
| 最大单笔收益 | +18,606.88 (+37.95%) |
| 最大单笔亏损 | -14,737.81 (-30.83%) |

**买入排名分布**:
- rank_t1 = 1: 42笔 (87.5%)
- rank_t1 = 2: 6笔 (12.5%)

**退出原因**:
- not_limit_up: 40笔
- not_limit_up_and_rank_drop: 8笔

### 策略B：优先买入人气低的（rank 10→1）

| 指标 | 数值 |
|------|------|
| 交易笔数 | 69笔 |
| 最终净值 | 44,307.27 |
| **总收益率** | **-55.69%** |
| 盈利笔数 | 25笔 (36.2%) |
| 亏损笔数 | 44笔 (63.8%) |
| 平均持仓天数 | 2.01天 |
| 平均收益率 | -1.58% |
| 盈利交易平均收益 | +2,449.07 (+5.13%) |
| 亏损交易平均亏损 | -2,657.26 (-5.40%) |
| 最大单笔收益 | +7,498.46 (+15.24%) |
| 最大单笔亏损 | -8,734.76 (-17.55%) |

**买入排名分布**:
- rank_t1 = 10: 68笔 (98.6%)
- rank_t1 = 9: 1笔 (1.4%)

**退出原因**:
- not_limit_up_and_rank_drop: 44笔
- not_limit_up: 25笔

## 核心发现

### 1. 总体表现对比
- 策略B（优先买人气低的）收益率**略好于**策略A：-55.69% vs -57.20%（相对改善2.6%）
- 两者都产生了较大的亏损，说明该策略在2025年表现不佳

### 2. 交易频率差异
- 策略B交易次数更多（69 vs 48笔），说明排名靠后的股票更容易满足买入条件
- 策略B平均持仓时间更短（2.01 vs 2.17天），说明排名靠后的股票波动更快

### 3. 盈亏特征对比

| 维度 | 策略A (rank 1→10) | 策略B (rank 10→1) | 分析 |
|------|-------------------|-------------------|------|
| 胜率 | 35.4% | 36.2% | 几乎相同 |
| 盈利幅度 | +7.47% | +5.13% | A更高 |
| 亏损幅度 | -7.93% | -5.40% | B更小 |
| 盈亏比 | 0.95 | 0.92 | 几乎相同 |
| 极端收益 | +37.95% | +15.24% | A波动更大 |
| 极端亏损 | -30.83% | -17.55% | A风险更高 |

### 4. 退出原因差异
- 策略A：83%因"not_limit_up"退出（多数是人气仍高但未涨停）
- 策略B：64%因"not_limit_up_and_rank_drop"退出（人气衰退更快）

这说明：
- **人气高的股票（rank=1）**: 人气更持久，但容易在未涨停时就退出
- **人气低的股票（rank=10）**: 人气衰退更快，更容易跌出前50名

## 结论与建议

### 1. 策略有效性评估
❌ **两种优先级策略在2025年都表现不佳**
- 55-57%的亏损幅度表明该策略不适合2025年市场环境
- 可能原因：
  - 市场追涨情绪弱，人气股持续性差
  - T日开盘买入时机不佳（可能被"割韭菜"）
  - 涨停板持续性弱，导致频繁止损

### 2. 买入优先级影响
📊 **优先买入排名靠后的股票（rank=10）略胜一筹**
- 收益率改善：2.6个百分点
- 风险控制：最大单笔亏损降低43%（-17.55% vs -30.83%）
- 交易机会：交易次数增加44%（69 vs 48笔）

**但改善幅度有限，不足以改变策略整体亏损的结果。**

### 3. 优化方向建议

#### 短期可尝试优化：
1. **调整卖出条件**：
   - 放宽卖出标准（如允许非涨停但涨幅>5%时继续持有）
   - 增加止损条件（如单笔亏损>-10%时强制卖出）
   
2. **改变买入时机**：
   - 测试T日尾盘买入（避免开盘追高）
   - 测试T+1日低点买入（人气股回调时介入）

3. **增加过滤条件**：
   - 要求T-1日成交额>某阈值（过滤低流动性股票）
   - 要求T-1日涨幅在合理区间（避免高位接盘）

#### 长期建议：
- 考虑反向策略：做空人气榜股票或买入人气榜外的低估股
- 结合其他指标：如技术指标、基本面筛选
- 分段回测：分析不同市场阶段（牛市/熊市/震荡市）的表现差异

## 附录：代码修改说明

修改文件：`scripts/backtest_hot_rank_top10_open_strategy.py`

**修改位置1**（第344行）：
```python
# 策略A（原版）
df_prev_hot = df_prev_hot.sort_values('hot_rank', ascending=True)

# 策略B（修改后）
df_prev_hot = df_prev_hot.sort_values('hot_rank', ascending=False)
```

**修改说明**：
- `ascending=True`：hot_rank从小到大排序（1,2,3...10），优先买入排名靠前的
- `ascending=False`：hot_rank从大到小排序（10,9,8...1），优先买入排名靠后的

---

*报告生成时间: 2026-01-05 22:15*  
*回测引擎版本: v1.0.0*  
*数据源: data/processed/features/daily_features_v1.parquet*
